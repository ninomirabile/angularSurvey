import{b as _e,d as ke,e as we}from"./chunk-CHSEUBSY.js";import{f as W,g as ge,h as Se,k as H}from"./chunk-K2ZAMQTP.js";import{Da as x,Dc as pe,Ea as re,Fb as ue,Hb as G,I as u,Jb as V,Lc as he,Oa as F,Oc as fe,Qa as C,Qc as ve,Ra as ne,Sa as ie,Va as ae,Wa as j,X as O,Y as Z,_ as y,a as l,ab as se,b as B,bb as oe,ca as g,cb as ce,cc as me,e as _,fa as M,h as v,ha as c,ib as D,jb as A,jd as be,k as S,kb as le,l as P,la as J,ld as X,ma as Y,pa as w,pb as de,qa as ee,rb as N,s as f,t as d,tb as q,u as p,wd as ye,x as b,xb as L,yb as z,za as te,zb as $}from"./chunk-V5MVE5CM.js";var E=class a{STORAGE_PREFIX="survey_app_";db=null;DB_NAME="SurveyAppDB";DB_VERSION=1;constructor(){this.initIndexedDB()}setItem(t,e,r){let n={key:this.getFullKey(t),value:e,timestamp:Date.now(),expiresAt:r?Date.now()+r:void 0};try{localStorage.setItem(n.key,JSON.stringify(n))}catch(i){console.error("Error saving to localStorage:",i)}}getItem(t){try{let e=localStorage.getItem(this.getFullKey(t));if(!e)return null;let r=JSON.parse(e);return r.expiresAt&&Date.now()>r.expiresAt?(this.removeItem(t),null):r.value}catch(e){return console.error("Error reading from localStorage:",e),null}}removeItem(t){try{localStorage.removeItem(this.getFullKey(t))}catch(e){console.error("Error removing from localStorage:",e)}}clear(){try{Object.keys(localStorage).forEach(e=>{e.startsWith(this.STORAGE_PREFIX)&&localStorage.removeItem(e)})}catch(t){console.error("Error clearing localStorage:",t)}}initIndexedDB(){if(!window.indexedDB){console.warn("IndexedDB not supported, falling back to localStorage");return}let t=indexedDB.open(this.DB_NAME,this.DB_VERSION);t.onerror=e=>{console.error("Error opening IndexedDB:",e),this.db=null},t.onsuccess=e=>{this.db=e.target.result,console.log("IndexedDB initialized successfully")},t.onupgradeneeded=e=>{let r=e.target.result;if(!r.objectStoreNames.contains("surveys")){let n=r.createObjectStore("surveys",{keyPath:"id"});n.createIndex("title","title",{unique:!1}),n.createIndex("authorId","authorId",{unique:!1}),n.createIndex("isPublished","isPublished",{unique:!1})}if(!r.objectStoreNames.contains("responses")){let n=r.createObjectStore("responses",{keyPath:"id"});n.createIndex("surveyId","surveyId",{unique:!1}),n.createIndex("respondentId","respondentId",{unique:!1})}if(!r.objectStoreNames.contains("templates")){let n=r.createObjectStore("templates",{keyPath:"id"});n.createIndex("category","category",{unique:!1}),n.createIndex("isPublic","isPublic",{unique:!1})}}}saveSurvey(t){return this.db?f(this.saveToIndexedDB("surveys",t)).pipe(u(e=>(console.warn("IndexedDB failed, falling back to localStorage:",e),this.setItem(`survey_${t.id}`,t),d(void 0)))):(this.setItem(`survey_${t.id}`,t),d(void 0))}getSurvey(t){return this.db?f(this.getFromIndexedDB("surveys",t)).pipe(u(e=>(console.warn("IndexedDB failed, falling back to localStorage:",e),d(this.getItem(`survey_${t}`))))):d(this.getItem(`survey_${t}`))}getAllSurveys(){return this.db?f(this.getAllFromIndexedDB("surveys")).pipe(u(t=>(console.warn("IndexedDB failed, falling back to localStorage:",t),this.getAllFromLocalStorage()))):this.getAllFromLocalStorage()}getAllFromLocalStorage(){let t=[];try{Object.keys(localStorage).forEach(r=>{if(r.startsWith(this.STORAGE_PREFIX+"survey_")){let n=r.replace(this.STORAGE_PREFIX,""),i=this.getItem(n);i&&t.push(i)}})}catch(e){console.error("Error reading from localStorage:",e)}return d(t)}deleteSurvey(t){return this.db?f(this.deleteFromIndexedDB("surveys",t)).pipe(u(e=>(console.warn("IndexedDB failed, falling back to localStorage:",e),this.removeItem(`survey_${t}`),d(void 0)))):(this.removeItem(`survey_${t}`),d(void 0))}saveResponse(t){return this.db?f(this.saveToIndexedDB("responses",t)).pipe(u(e=>(console.warn("IndexedDB failed for responses, using localStorage:",e),this.setItem(`response_${t.id}`,t),d(void 0)))):(this.setItem(`response_${t.id}`,t),d(void 0))}getResponsesBySurveyId(t){return this.db?f(this.getByIndex("responses","surveyId",t)).pipe(u(e=>(console.warn("IndexedDB failed for responses, using localStorage:",e),this.getResponsesFromLocalStorage(t)))):this.getResponsesFromLocalStorage(t)}getResponsesFromLocalStorage(t){let e=[];try{Object.keys(localStorage).forEach(n=>{if(n.startsWith(this.STORAGE_PREFIX+"response_")){let i=n.replace(this.STORAGE_PREFIX,""),s=this.getItem(i);s&&typeof s=="object"&&"surveyId"in s&&s.surveyId===t&&e.push(s)}})}catch(r){console.error("Error reading responses from localStorage:",r)}return d(e)}saveTemplate(t){return this.db?f(this.saveToIndexedDB("templates",t)).pipe(u(e=>(console.warn("IndexedDB failed for templates, using localStorage:",e),this.setItem(`template_${t.id}`,t),d(void 0)))):(this.setItem(`template_${t.id}`,t),d(void 0))}getAllTemplates(){return this.db?f(this.getAllFromIndexedDB("templates")).pipe(u(t=>(console.warn("IndexedDB failed for templates, using localStorage:",t),this.getAllTemplatesFromLocalStorage()))):this.getAllTemplatesFromLocalStorage()}getAllTemplatesFromLocalStorage(){let t=[];try{Object.keys(localStorage).forEach(r=>{if(r.startsWith(this.STORAGE_PREFIX+"template_")){let n=r.replace(this.STORAGE_PREFIX,""),i=this.getItem(n);i&&t.push(i)}})}catch(e){console.error("Error reading templates from localStorage:",e)}return d(t)}saveToIndexedDB(t,e){return _(this,null,function*(){return new Promise((r,n)=>{if(!this.db){n(new Error("IndexedDB not initialized"));return}let o=this.db.transaction([t],"readwrite").objectStore(t).put(e);o.onsuccess=()=>r(),o.onerror=()=>n(o.error)})})}getFromIndexedDB(t,e){return _(this,null,function*(){return new Promise((r,n)=>{if(!this.db){n(new Error("IndexedDB not initialized"));return}let o=this.db.transaction([t],"readonly").objectStore(t).get(e);o.onsuccess=()=>r(o.result),o.onerror=()=>n(o.error)})})}getAllFromIndexedDB(t){return _(this,null,function*(){return new Promise((e,r)=>{if(!this.db){r(new Error("IndexedDB not initialized"));return}let s=this.db.transaction([t],"readonly").objectStore(t).getAll();s.onsuccess=()=>e(s.result),s.onerror=()=>r(s.error)})})}deleteFromIndexedDB(t,e){return _(this,null,function*(){return new Promise((r,n)=>{if(!this.db){n(new Error("IndexedDB not initialized"));return}let o=this.db.transaction([t],"readwrite").objectStore(t).delete(e);o.onsuccess=()=>r(),o.onerror=()=>n(o.error)})})}getByIndex(t,e,r){return _(this,null,function*(){return new Promise((n,i)=>{if(!this.db){i(new Error("IndexedDB not initialized"));return}let h=this.db.transaction([t],"readonly").objectStore(t).index(e).getAll(r);h.onsuccess=()=>n(h.result),h.onerror=()=>i(h.error)})})}getFullKey(t){return`${this.STORAGE_PREFIX}${t}`}getStorageSize(){return new v(t=>{let e=0;try{Object.keys(localStorage).forEach(n=>{n.startsWith(this.STORAGE_PREFIX)&&(e+=localStorage[n].length)})}catch(r){console.error("Error calculating localStorage size:",r)}t.next({localStorage:e,indexedDB:0}),t.complete()})}clearAll(){return new v(t=>{if(this.clear(),this.db){let e=this.db.transaction(["surveys","responses","templates"],"readwrite");e.oncomplete=()=>{t.next(),t.complete()},e.onerror=()=>{t.error(e.error)}}else t.next(),t.complete()})}resetToSampleData(){return new v(t=>{this.clear(),[{id:"1",title:"Customer Feedback Survey",description:"Help us improve our services by providing your valuable feedback",isPublic:!0,isPublished:!0,createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-20"),settings:{allowAnonymous:!0,requireEmail:!1,allowMultipleResponses:!1,showProgressBar:!0,showQuestionNumbers:!0,enableBackButton:!0,autoSave:!0,theme:{primaryColor:"#1976d2",secondaryColor:"#dc004e",backgroundColor:"#ffffff",textColor:"#000000",borderRadius:8,fontFamily:"Roboto, sans-serif"}},questions:[{id:"q1",type:"text",title:"What is your name?",description:"Please enter your full name",required:!0,order:0},{id:"q2",type:"rating",title:"How satisfied are you with our service?",description:"Rate your satisfaction from 1 to 5",required:!0,order:1},{id:"q3",type:"textarea",title:"Additional comments",description:"Please share any additional feedback",required:!1,order:2}],version:1,authorId:"admin",tags:["customer","feedback","service"]},{id:"2",title:"Employee Satisfaction Survey",description:"Annual employee satisfaction and engagement survey",isPublic:!1,isPublished:!1,createdAt:new Date("2024-01-10"),updatedAt:new Date("2024-01-12"),settings:{allowAnonymous:!1,requireEmail:!0,allowMultipleResponses:!1,showProgressBar:!0,showQuestionNumbers:!0,enableBackButton:!0,autoSave:!0,theme:{primaryColor:"#4caf50",secondaryColor:"#ff9800",backgroundColor:"#ffffff",textColor:"#000000",borderRadius:8,fontFamily:"Roboto, sans-serif"}},questions:[{id:"q1",type:"radio",title:"How would you rate your work-life balance?",description:"Select the option that best describes your situation",required:!0,order:0,options:[{id:"opt1",label:"Excellent",value:"excellent",order:0},{id:"opt2",label:"Good",value:"good",order:1},{id:"opt3",label:"Fair",value:"fair",order:2},{id:"opt4",label:"Poor",value:"poor",order:3}]}],version:1,authorId:"admin",tags:["employee","satisfaction","hr"]}].forEach(r=>{this.setItem(`survey_${r.id}`,r)}),t.next(),t.complete()})}isStorageAvailable(){return new v(t=>{let e={indexedDB:!!this.db,localStorage:!1};try{let r="__storage_test__";localStorage.setItem(r,"test"),localStorage.removeItem(r),e.localStorage=!0}catch(r){console.warn("localStorage not available:",r)}t.next(e),t.complete()})}static \u0275fac=function(e){return new(e||a)};static \u0275prov=g({token:a,factory:a.\u0275fac,providedIn:"root"})};function Be(a,t){if(a&1){let e=de();D(0,"div",1)(1,"button",2),N("click",function(){J(e);let n=q();return Y(n.action())}),G(2),A()()}if(a&2){let e=q();x(2),V(" ",e.data.action," ")}}var Oe=["label"];function Ce(a,t){}var De=Math.pow(2,31)-1,I=class{_overlayRef;instance;containerInstance;_afterDismissed=new S;_afterOpened=new S;_onAction=new S;_durationTimeoutId;_dismissedByAction=!1;constructor(t,e){this._overlayRef=e,this.containerInstance=t,t._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(t){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(t,De))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}},xe=new M("MatSnackBarData"),k=class{politeness="polite";announcementMessage="";viewContainerRef;duration=0;panelClass;direction;data=null;horizontalPosition="center";verticalPosition="bottom"},Ee=(()=>{class a{static \u0275fac=function(r){return new(r||a)};static \u0275dir=C({type:a,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]})}return a})(),Te=(()=>{class a{static \u0275fac=function(r){return new(r||a)};static \u0275dir=C({type:a,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]})}return a})(),Re=(()=>{class a{static \u0275fac=function(r){return new(r||a)};static \u0275dir=C({type:a,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]})}return a})(),Pe=(()=>{class a{snackBarRef=c(I);data=c(xe);constructor(){}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}static \u0275fac=function(r){return new(r||a)};static \u0275cmp=F({type:a,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["matButton","","matSnackBarAction","",3,"click"]],template:function(r,n){r&1&&(D(0,"div",0),G(1),A(),oe(2,Be,3,1,"div",1)),r&2&&(x(),V(" ",n.data.message,`
`),x(),ce(n.hasAction?2:-1))},dependencies:[ye,Ee,Te,Re],styles:[`.mat-mdc-simple-snack-bar{display:flex}
`],encapsulation:2,changeDetection:0})}return a})(),U="_mat-snack-bar-enter",Q="_mat-snack-bar-exit",Me=(()=>{class a extends Se{_ngZone=c(ae);_elementRef=c(te);_changeDetectorRef=c(me);_platform=c(pe);_animationsDisabled=X();snackBarConfig=c(k);_document=c(ee);_trackedModals=new Set;_enterFallback;_exitFallback;_injector=c(w);_announceDelay=150;_announceTimeoutId;_destroyed=!1;_portalOutlet;_onAnnounce=new S;_onExit=new S;_onEnter=new S;_animationState="void";_live;_label;_role;_liveElementId=c(ve).getId("mat-snack-bar-container-live-");constructor(){super();let e=this.snackBarConfig;e.politeness==="assertive"&&!e.announcementMessage?this._live="assertive":e.politeness==="off"?this._live="off":this._live="polite",this._platform.FIREFOX&&(this._live==="polite"&&(this._role="status"),this._live==="assertive"&&(this._role="alert"))}attachComponentPortal(e){this._assertNotAttached();let r=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),r}attachTemplatePortal(e){this._assertNotAttached();let r=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),r}attachDomPortal=e=>{this._assertNotAttached();let r=this._portalOutlet.attachDomPortal(e);return this._afterPortalAttached(),r};onAnimationEnd(e){e===Q?this._completeExit():e===U&&(clearTimeout(this._enterFallback),this._ngZone.run(()=>{this._onEnter.next(),this._onEnter.complete()}))}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce(),this._animationsDisabled?j(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(U)))},{injector:this._injector}):(clearTimeout(this._enterFallback),this._enterFallback=setTimeout(()=>{this._elementRef.nativeElement.classList.add("mat-snack-bar-fallback-visible"),this.onAnimationEnd(U)},200)))}exit(){return this._destroyed?d(void 0):(this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId),this._animationsDisabled?j(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(Q)))},{injector:this._injector}):(clearTimeout(this._exitFallback),this._exitFallback=setTimeout(()=>this.onAnimationEnd(Q),200))}),this._onExit)}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit()}_completeExit(){clearTimeout(this._exitFallback),queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){let e=this._elementRef.nativeElement,r=this.snackBarConfig.panelClass;r&&(Array.isArray(r)?r.forEach(s=>e.classList.add(s)):e.classList.add(r)),this._exposeToModals();let n=this._label.nativeElement,i="mdc-snackbar__label";n.classList.toggle(i,!n.querySelector(`.${i}`))}_exposeToModals(){let e=this._liveElementId,r=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let n=0;n<r.length;n++){let i=r[n],s=i.getAttribute("aria-owns");this._trackedModals.add(i),s?s.indexOf(e)===-1&&i.setAttribute("aria-owns",s+" "+e):i.setAttribute("aria-owns",e)}}_clearFromModals(){this._trackedModals.forEach(e=>{let r=e.getAttribute("aria-owns");if(r){let n=r.replace(this._liveElementId,"").trim();n.length>0?e.setAttribute("aria-owns",n):e.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{if(this._destroyed)return;let e=this._elementRef.nativeElement,r=e.querySelector("[aria-hidden]"),n=e.querySelector("[aria-live]");if(r&&n){let i=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&r.contains(document.activeElement)&&(i=document.activeElement),r.removeAttribute("aria-hidden"),n.appendChild(r),i?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}static \u0275fac=function(r){return new(r||a)};static \u0275cmp=F({type:a,selectors:[["mat-snack-bar-container"]],viewQuery:function(r,n){if(r&1&&(L(H,7),L(Oe,7)),r&2){let i;z(i=$())&&(n._portalOutlet=i.first),z(i=$())&&(n._label=i.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container"],hostVars:6,hostBindings:function(r,n){r&1&&N("animationend",function(s){return n.onAnimationEnd(s.animationName)})("animationcancel",function(s){return n.onAnimationEnd(s.animationName)}),r&2&&ue("mat-snack-bar-container-enter",n._animationState==="visible")("mat-snack-bar-container-exit",n._animationState==="hidden")("mat-snack-bar-container-animations-enabled",!n._animationsDisabled)},features:[ne],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface","mat-mdc-snackbar-surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(r,n){r&1&&(D(0,"div",1)(1,"div",2,0)(3,"div",3),ie(4,Ce,0,0,"ng-template",4),A(),le(5,"div"),A()()),r&2&&(x(5),se("aria-live",n._live)("role",n._role)("id",n._liveElementId))},dependencies:[H],styles:[`@keyframes _mat-snack-bar-enter{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}@keyframes _mat-snack-bar-exit{from{opacity:1}to{opacity:0}}.mat-mdc-snack-bar-container{display:flex;align-items:center;justify-content:center;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);margin:8px}.mat-mdc-snack-bar-handset .mat-mdc-snack-bar-container{width:100vw}.mat-snack-bar-container-animations-enabled{opacity:0}.mat-snack-bar-container-animations-enabled.mat-snack-bar-fallback-visible{opacity:1}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-enter{animation:_mat-snack-bar-enter 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-exit{animation:_mat-snack-bar-exit 75ms cubic-bezier(0.4, 0, 1, 1) forwards}.mat-mdc-snackbar-surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;padding-left:0;padding-right:8px}[dir=rtl] .mat-mdc-snackbar-surface{padding-right:0;padding-left:8px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{min-width:344px;max-width:672px}.mat-mdc-snack-bar-handset .mat-mdc-snackbar-surface{width:100%;min-width:0}@media(forced-colors: active){.mat-mdc-snackbar-surface{outline:solid 1px}}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{color:var(--mat-snack-bar-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mat-snack-bar-container-shape, var(--mat-sys-corner-extra-small));background-color:var(--mat-snack-bar-container-color, var(--mat-sys-inverse-surface))}.mdc-snackbar__label{width:100%;flex-grow:1;box-sizing:border-box;margin:0;padding:14px 8px 14px 16px}[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-family:var(--mat-snack-bar-supporting-text-font, var(--mat-sys-body-medium-font));font-size:var(--mat-snack-bar-supporting-text-size, var(--mat-sys-body-medium-size));font-weight:var(--mat-snack-bar-supporting-text-weight, var(--mat-sys-body-medium-weight));line-height:var(--mat-snack-bar-supporting-text-line-height, var(--mat-sys-body-medium-line-height))}.mat-mdc-snack-bar-actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){--mat-button-text-state-layer-color: currentColor;--mat-button-text-ripple-color: currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled).mat-unthemed{color:var(--mat-snack-bar-button-color, var(--mat-sys-inverse-primary))}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}
`],encapsulation:2})}return a})();function Fe(){return new k}var je=new M("mat-snack-bar-default-options",{providedIn:"root",factory:Fe}),Ae=(()=>{class a{_live=c(fe);_injector=c(w);_breakpointObserver=c(he);_parentSnackBar=c(a,{optional:!0,skipSelf:!0});_defaultConfig=c(je);_animationsDisabled=X();_snackBarRefAtThisLevel=null;simpleSnackBarComponent=Pe;snackBarContainerComponent=Me;handsetCssClass="mat-mdc-snack-bar-handset";get _openedSnackBarRef(){let e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}constructor(){}openFromComponent(e,r){return this._attach(e,r)}openFromTemplate(e,r){return this._attach(e,r)}open(e,r="",n){let i=l(l({},this._defaultConfig),n);return i.data={message:e,action:r},i.announcementMessage===e&&(i.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,i)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,r){let n=r&&r.viewContainerRef&&r.viewContainerRef.injector,i=w.create({parent:n||this._injector,providers:[{provide:k,useValue:r}]}),s=new W(this.snackBarContainerComponent,r.viewContainerRef,i),o=e.attach(s);return o.instance.snackBarConfig=r,o.instance}_attach(e,r){let n=l(l(l({},new k),this._defaultConfig),r),i=this._createOverlay(n),s=this._attachSnackBarContainer(i,n),o=new I(s,i);if(e instanceof re){let m=new ge(e,null,{$implicit:n.data,snackBarRef:o});o.instance=s.attachTemplatePortal(m)}else{let m=this._createInjector(n,o),h=new W(e,void 0,m),R=s.attachComponentPortal(h);o.instance=R.instance}return this._breakpointObserver.observe(be.HandsetPortrait).pipe(Z(i.detachments())).subscribe(m=>{i.overlayElement.classList.toggle(this.handsetCssClass,m.matches)}),n.announcementMessage&&s._onAnnounce.subscribe(()=>{this._live.announce(n.announcementMessage,n.politeness)}),this._animateSnackBar(o,n),this._openedSnackBarRef=o,this._openedSnackBarRef}_animateSnackBar(e,r){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),r.announcementMessage&&this._live.clear()}),r.duration&&r.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(r.duration)),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter()}_createOverlay(e){let r=new _e;r.direction=e.direction;let n=ke(this._injector),i=e.direction==="rtl",s=e.horizontalPosition==="left"||e.horizontalPosition==="start"&&!i||e.horizontalPosition==="end"&&i,o=!s&&e.horizontalPosition!=="center";return s?n.left("0"):o?n.right("0"):n.centerHorizontally(),e.verticalPosition==="top"?n.top("0"):n.bottom("0"),r.positionStrategy=n,r.disableAnimations=this._animationsDisabled,we(this._injector,r)}_createInjector(e,r){let n=e&&e.viewContainerRef&&e.viewContainerRef.injector;return w.create({parent:n||this._injector,providers:[{provide:I,useValue:r},{provide:xe,useValue:e.data}]})}static \u0275fac=function(r){return new(r||a)};static \u0275prov=g({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var T=class a{snackBar=c(Ae);DEFAULT_CONFIG={duration:4e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["notification-snackbar"]};TYPE_CONFIGS={success:{panelClass:["notification-snackbar","notification-success"],duration:3e3},error:{panelClass:["notification-snackbar","notification-error"],duration:6e3},warning:{panelClass:["notification-snackbar","notification-warning"],duration:5e3},info:{panelClass:["notification-snackbar","notification-info"],duration:4e3}};success(t,e){return this.show(t,"success",e)}error(t,e){return this.show(t,"error",e)}warning(t,e){return this.show(t,"warning",e)}info(t,e){return this.show(t,"info",e)}show(t,e="info",r){let n=this.buildConfig(e,r),i=this.snackBar.open(t,r?.action||"Close",n);return new v(s=>{i.afterDismissed().subscribe(()=>{s.next(),s.complete()})})}buildConfig(t,e){let r=l({},this.DEFAULT_CONFIG),n=l({},this.TYPE_CONFIGS[t]),i=e?this.mapOptionsToConfig(e):{};return l(l(l({},r),n),i)}mapOptionsToConfig(t){let e={};return t.duration!==void 0&&(e.duration=t.duration),t.horizontalPosition&&(e.horizontalPosition=t.horizontalPosition),t.verticalPosition&&(e.verticalPosition=t.verticalPosition),t.panelClass&&(e.panelClass=t.panelClass),e}showSaveSuccess(t="Item"){return this.success(`${t} saved successfully!`)}showDeleteSuccess(t="Item"){return this.success(`${t} deleted successfully!`)}showUpdateSuccess(t="Item"){return this.success(`${t} updated successfully!`)}showNetworkError(){return this.error("Network error. Please check your connection and try again.")}showValidationError(t){let e=t?`Please check the ${t} field.`:"Please check the form for errors.";return this.error(e)}showPermissionError(){return this.error("You don't have permission to perform this action.")}showLoadingMessage(t="Loading..."){return this.info(t,{duration:0})}dismissAll(){this.snackBar.dismiss()}showWithAction(t,e,r,n="info",i){let s=this.buildConfig(n,i),o=this.snackBar.open(t,e,s);return o.onAction().subscribe(()=>{r()}),new v(m=>{o.afterDismissed().subscribe(()=>{m.next(),m.complete()})})}static \u0275fac=function(e){return new(e||a)};static \u0275prov=g({token:a,factory:a.\u0275fac,providedIn:"root"})};var Ie=class a{storage=c(E);notificationService=c(T);surveysSubject=new P([]);currentSurveySubject=new P(null);surveys$=this.surveysSubject.asObservable();currentSurvey$=this.currentSurveySubject.asObservable();constructor(){this.loadSurveys()}createSurvey(t){let e={id:this.generateId(),title:t.title||"Untitled Survey",description:t.description||"",isPublic:t.isPublic||!1,isPublished:t.isPublished||!1,createdAt:new Date,updatedAt:new Date,settings:l({allowAnonymous:!0,requireEmail:!1,allowMultipleResponses:!1,showProgressBar:!0,showQuestionNumbers:!0,enableBackButton:!0,autoSave:!0,theme:{primaryColor:"#1976d2",secondaryColor:"#dc004e",backgroundColor:"#ffffff",textColor:"#000000",borderRadius:8,fontFamily:"Roboto, sans-serif"}},t.settings),questions:t.questions||[],version:1,authorId:t.authorId,tags:t.tags||[]};return this.storage.saveSurvey(e).pipe(y(()=>{this.addSurveyToCache(e),this.notificationService.showSaveSuccess("Survey")}),b(()=>e),u(r=>(this.notificationService.showNetworkError(),p(()=>r))))}updateSurvey(t,e){return this.getSurvey(t).pipe(O(r=>{if(!r)return p(()=>new Error("Survey not found"));let n=B(l(l({},r),e),{updatedAt:new Date,version:r.version+1});return this.storage.saveSurvey(n).pipe(y(()=>{this.updateSurveyInCache(n),this.notificationService.showUpdateSuccess("Survey")}),b(()=>n),u(i=>(this.notificationService.showNetworkError(),p(()=>i))))}))}getSurvey(t){return this.storage.getSurvey(t).pipe(u(e=>(console.error("Error fetching survey:",e),d(null))))}getAllSurveys(){return this.storage.getAllSurveys().pipe(y(t=>{this.surveysSubject.next(t)}),u(t=>(console.error("Error fetching surveys:",t),d([]))))}deleteSurvey(t){return this.storage.deleteSurvey(t).pipe(y(()=>{this.removeSurveyFromCache(t),this.notificationService.showDeleteSuccess("Survey")}),u(e=>(this.notificationService.showNetworkError(),p(()=>e))))}publishSurvey(t){return this.updateSurvey(t,{isPublished:!0})}unpublishSurvey(t){return this.updateSurvey(t,{isPublished:!1})}saveResponse(t){return this.storage.saveResponse(t).pipe(y(()=>{this.notificationService.success("Response saved successfully!")}),u(e=>(this.notificationService.showNetworkError(),p(()=>e))))}getResponsesBySurveyId(t){return this.storage.getResponsesBySurveyId(t)}saveTemplate(t){return this.storage.saveTemplate(t).pipe(y(()=>{this.notificationService.showSaveSuccess("Template")}),u(e=>(this.notificationService.showNetworkError(),p(()=>e))))}getAllTemplates(){return this.storage.getAllTemplates()}createFromTemplate(t,e){return this.storage.getAllTemplates().pipe(O(r=>{let n=r.find(s=>s.id===t);if(!n)return p(()=>new Error("Template not found"));let i=B(l(l({},n.survey),e),{id:void 0,createdAt:new Date,updatedAt:new Date,isPublished:!1});return this.createSurvey(i)}))}searchSurveys(t){return this.getAllSurveys().pipe(b(e=>e.filter(r=>r.title.toLowerCase().includes(t.toLowerCase())||r.description.toLowerCase().includes(t.toLowerCase())||r.tags?.some(n=>n.toLowerCase().includes(t.toLowerCase())))))}getSurveysByAuthor(t){return this.getAllSurveys().pipe(b(e=>e.filter(r=>r.authorId===t)))}getPublishedSurveys(){return this.getAllSurveys().pipe(b(t=>t.filter(e=>e.isPublished)))}exportSurvey(t){return this.getSurvey(t).pipe(b(e=>{if(!e)throw new Error("Survey not found");return JSON.stringify(e,null,2)}))}importSurvey(t){try{let e=JSON.parse(t);return this.createSurvey(e)}catch{return p(()=>new Error("Invalid JSON format"))}}duplicateSurvey(t){return this.getSurvey(t).pipe(O(e=>{if(!e)return p(()=>new Error("Survey not found"));let r=B(l({},e),{id:void 0,title:`${e.title} (Copy)`,isPublished:!1,createdAt:new Date,updatedAt:new Date,version:1});return this.createSurvey(r)}))}getSurveyAnalytics(t){return this.getResponsesBySurveyId(t).pipe(b(e=>{let r=e.length,n=e.filter(m=>m.isComplete).length,i=r>0?n/r*100:0,s=e.filter(m=>m.isComplete&&m.completedAt),o=s.length>0?s.reduce((m,h)=>{let R=h.completedAt.getTime()-h.startedAt.getTime();return m+R},0)/s.length:0;return{totalResponses:r,completedResponses:n,completionRate:i,avgTimeToComplete:o,responsesByDate:this.groupResponsesByDate(e)}}))}loadSurveys(){this.storage.getAllSurveys().subscribe(t=>{t.length===0?this.createSampleSurveys():this.surveysSubject.next(t)})}createSampleSurveys(){this.storage.resetToSampleData().subscribe(()=>{this.storage.getAllSurveys().subscribe(t=>{this.surveysSubject.next(t)})})}addSurveyToCache(t){let e=this.surveysSubject.value;this.surveysSubject.next([...e,t])}updateSurveyInCache(t){let r=this.surveysSubject.value.map(n=>n.id===t.id?t:n);this.surveysSubject.next(r)}removeSurveyFromCache(t){let r=this.surveysSubject.value.filter(n=>n.id!==t);this.surveysSubject.next(r)}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}groupResponsesByDate(t){return t.reduce((e,r)=>{let n=r.startedAt.toISOString().split("T")[0];return e[n]=(e[n]||0)+1,e},{})}setCurrentSurvey(t){this.currentSurveySubject.next(t)}getCurrentSurvey(){return this.currentSurveySubject.value}clearCurrentSurvey(){this.currentSurveySubject.next(null)}resetToSampleData(){return this.storage.resetToSampleData().pipe(y(()=>{this.loadSurveys(),this.notificationService.success("Data reset successfully!")}),u(t=>(this.notificationService.error("Failed to reset data"),p(()=>t))))}checkStorageAvailability(){return this.storage.isStorageAvailable()}static \u0275fac=function(e){return new(e||a)};static \u0275prov=g({token:a,factory:a.\u0275fac,providedIn:"root"})};export{E as a,T as b,Ie as c};
